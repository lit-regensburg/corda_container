---
title: "R Notebook"
output: html_notebook
---
```{r}
library(rjson)
```
```{r}
descriptor <- as.data.frame(rjson::fromJSON(file = "workflow_descriptor.json"))
descriptor
```

```{r}
counts <- read.delim(file=descriptor$inputData.name, sep=",")
sample_info <- read.delim(file=descriptor$groups.name, sep=",")
groups <- factor(sample_info$dexamethasone)
data_set <- DGEList(counts=counts, group=groups)
toKeep <- filterByExpr(data_set)
data_set <- data_set[toKeep,,keep.lib.sizes=FALSE]
data_set <- calcNormFactors(data_set)
design <- model.matrix(~groups)
data_set <- estimateDisp(data_set, design)
fit <- glmQLFit(data_set, design)
qlf <- glmQLFTest(fit) 
topTags(qlf)
```
